Authors:										May - June 2022
	Felipe Cupito
	Juan Manuel De Luca
	Azul Kim
	Faustino Maggioni Duffy
	
					WANNAPPROVE Protocol Version 0

1. Introduction

The protocol defined here allows an administrator user for a server implementing SOCKS5 [1]. The main actions that this administrator can do are changing settings of the server and its state, mainly the users’ information. 

2. Procedure

When a TCP-based client wishes to take control of a SOCKS5 server, it must open a TCP connection to the WANNAPROVE (8080) port on the server system. Then, if this requestes succeed, the client enters must authenticate with the right admin password to be allowed to connect. For this it must sent the request details.

The WANNAPROVE request is structured thus:

	+--------+---------+----------+
	|VERSION | PASSLEN |  PASSWD  |
	+--------+---------+----------+
	| X'00'  |  1      | 1 to 255 |
	+--------+---------+----------+
	
	Where:
		o VERSION protocol version: X’00’
		o PASSLEN number of bytes of the incoming password
		o PASSWD the actual password

Then the WANNAPROVE server will evaluate the format of the request and if the password is correct and response as follows:

	+--------+
	|STATUS  |
	+--------+
	| 1      |
	+--------+
	
	Where STATUS can be:
		      o OK X'00', the client has connected
		      o ERROR_IN_VERSION X'01', incorrect version number
			o ERROR_IN_PASSLEN: X'02', passlen was zero or negative
			o ERROR: X'03', unkown error
			o AUTH_FAIL: X'04', the password didn’t match
			
REQUEST

	Actions:
		- GET X'00'
		- PUT X'01'
		- EDIT X'02'
		- CONFIGBUFFSIZE X'03'
		- CONFIGSTATUS X'04'
		- DELETE X'05'
		
<<
	Request for GET ACTION
		+-------+---------+
		|ACTION | OPTION  |
		+-------+---------+
		| X'00' |  1      |
		+-------+---------+
			OPTION: 
				o USERS X'00'
				o PASSWORDS X'01'
				o BUFFERSIZE X'02'
				o AUTH STATUS X'03'
				o SPOOFING STATUS X'04'
				o SENT BYTES X'05'
				o RECEIVED BYTES X'06'
				o HISTORIC CONNECTIONS X'07'
				o CURRENT CONNECTIONS X'08'
>>
      	Replie for GET ACTION

		+---------+--------+----------+
		| STATUS  | RESLEN |  RES     |
		+---------+--------+----------+
		|  1      |   1    | VARIABLE |
		+---------+--------+----------+
		
		STATUS:
			o OK X'00'
			o ERROR_INVALID_ACTION X'01'
			o ERROR_INVALID_OPTION X'02'
			o ERRO X'03', unknown error
			
<<
	 Request for PUT ACTION
		+---------+--------+----------+----------+----------+----------+
		| ACTION  | FIELD  | NAMELEN  | NAME 	  | PASSLEN  | PASS     |
		+---------+--------+----------+----------+----------+----------+
		|  X'01'  | X'00'  | 1        | 1 to 255 | 1        | 1 to 255 |
		+---------+--------+----------+----------+----------+----------+
	
		ACTION: o PUT X'01'
		FIELD:  o USERS X'00'
		
>> 
	Replie for PUT ACTION
		+---------+
		| STATUS  |
		+---------+
		|  1      |
		+---------+
		
		STATUS:
			o OK X'00'
			o ERROR_INVALID_ACTION X'01'
			o ERROR_INVALID_FIELD X'02'
			o ERROR_INVALID_NAMELEN X'03'
			o ERROR_INVALID_PASSLEN X'04'
			o ERROR, unkown error X'05'

<<
	Request for EDIT ACTION
		+---------+--------+--------+-------------+-------------+-----------+-----------+
		| ACTION  | FIELD  | ULEN   | UNAME       | ATTRIBUTE   | VALUELEN  | VALUE     |
		+---------+--------+--------+-------------+-------------+-----------+-----------+
		|  X'02'  | X'00'  | 1      | 1 to 255    | 1           | 1         | 1 to 255  |
		+---------+--------+--------+-------------+-------------+-----------+-----------+
	
		ACTION: 	o EDIT X'02'
		FIELD:  	o USERS X'00'
		ATRIBUTE:	
				o USERNAME X'00'
				o PASSWORD X'01'
>> 
	Replie for EDIT ACTION
		+---------+
		| STATUS  |
		+---------+
		|  1      |
		+---------+
		
		STATUS:
			o OK X'00'
			o ERROR_INVALID_ACTION X'01'
			o ERROR_INVALID_FIELD X'02'
			o ERROR_INVALID_ULEN X'03'
			o ERROR_INVALID_ATTRIBUTE X'04'
			o ERROR_INVALID_VALUELEN X'05'
			o ERROR, unknown X'06'
			o UNKNOWN_USER_FAIL X'07'
			
<<
	Request for CONFIGBUFFSIZE ACTION
		+---------+---------+
		| ACTION  | SIZE    |
		+---------+---------+
		|  X'03'  |    4    |
		+---------+---------+
	
		ACTION: o BUFFSIZE X'03'
		
>> 	Replie for CONFIGBUFFSIZE ACTION

		+---------+
		| STATUS  |
		+---------+
		|  1      |
		+---------+
		
		STATUS:
			o OK X'00'
			o ERROR_INVALID_ACTION X'01'
			o ERROR_INVALID_SIZELEN X'02'
			o ERROR_INVALID_SIZE X'03'
			o ERROR X'04'

<<
	 Request for CONFIGSTATUS ACTION
		+---------+--------+--------+
		| ACTION  | FIELD  | STATUS |
		+---------+--------+--------+
		|  X'04'  | 1      | 1      |
		+---------+--------+--------+
	
		ACTION:	o CONFIG STATUS X'04'
		FIELD:		o AUTH X'03'
				o SPOOF X'04' 	
		STATUS:
			o ON X'00'
			o OFF X'01'

>>	Replie for CONFIGSTATUS ACTION

		+---------+
		| STATUS  |
		+---------+
		|  1      |
		+---------+
		
		STATUS:
			o OK X'00'	
			o ERROR_INVALID_ACTION X'01'
			o ERROR_INVALID_FIELD  X'02'
			o ERROR_INVALID_STATUS X'03'
			o ERROR X'04'
			
<<
	 Request for DELETE ACTION
		+---------+--------+---------+----------+
		| ACTION  | FIELD  | ULEN    | USERNAME |
		+---------+--------+---------+----------+
		|  X'05'  | X'00'  | 1       | 1 to 255 |
		+---------+--------+---------+----------+
	
		ACTION:  o DELETE X'05'
		FIELD:	 o USERS X'00'

>>	Replie for DELETE ACTION

		+---------+
		| STATUS  |
		+---------+
		|  1      |
		+---------+
		
		STATUS:
			o OK X'00'
			o ERROR_INVALID_ACTION X'01'
			o ERROR_INVALID_FIELD X'02'
			o ERROR_INVALID_ULEN X'03'
			o ERROR X'04'
			o UNKNOWN_USER_FAIL X'05'
9. References

[1] RFC 1928 – SOCKS Protocolo Version 5 			https://datatracker.ietf.org/doc/html/rfc1928
