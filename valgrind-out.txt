==1353== Memcheck, a memory error detector
==1353== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==1353== Using Valgrind-3.14.0-353a3587bb-20181007X and LibVEX; rerun with -h for copyright info
==1353== Command: ./server
==1353== Parent PID: 25
==1353== 
--1353-- 
--1353-- Valgrind options:
--1353--    --leak-check=full
--1353--    --show-leak-kinds=all
--1353--    --track-origins=yes
--1353--    --verbose
--1353--    --log-file=valgrind-out.txt
--1353-- Contents of /proc/version:
--1353--   Linux version 4.19.104-microsoft-standard (oe-user@oe-host) (gcc version 8.2.0 (GCC)) #1 SMP Wed Feb 19 06:37:35 UTC 2020
--1353-- 
--1353-- Arch and hwcaps: AMD64, LittleEndian, amd64-cx16-lzcnt-rdtscp-sse3-avx-avx2-bmi
--1353-- Page sizes: currently 4096, max supported 4096
--1353-- Valgrind library directory: /usr/lib/x86_64-linux-gnu/valgrind
--1353-- Reading syms from /mnt/c/Users/felip/Documents/GitHub/tp_protos/server
--1353-- Reading syms from /lib/x86_64-linux-gnu/ld-2.28.so
--1353--   Considering /usr/lib/debug/.build-id/41/da9039523c108974acf67fd0482ece36395436.debug ..
--1353--   .. build-id is valid
--1353-- Reading syms from /usr/lib/x86_64-linux-gnu/valgrind/memcheck-amd64-linux
--1353--   Considering /usr/lib/debug/.build-id/32/2e77af97f403c3d34ff09edf60b089e72ec889.debug ..
--1353--   .. build-id is valid
--1353--    object doesn't have a dynamic symbol table
--1353-- Scheduler: using generic scheduler lock implementation.
--1353-- Reading suppressions file: /usr/lib/x86_64-linux-gnu/valgrind/default.supp
==1353== embedded gdbserver: reading from /tmp/vgdb-pipe-from-vgdb-to-1353-by-felu-on-???
==1353== embedded gdbserver: writing to   /tmp/vgdb-pipe-to-vgdb-from-1353-by-felu-on-???
==1353== embedded gdbserver: shared mem   /tmp/vgdb-pipe-shared-mem-vgdb-1353-by-felu-on-???
==1353== 
==1353== TO CONTROL THIS PROCESS USING vgdb (which you probably
==1353== don't want to do, unless you know exactly what you're doing,
==1353== or are doing some strange experiment):
==1353==   /usr/lib/x86_64-linux-gnu/valgrind/../../bin/vgdb --pid=1353 ...command...
==1353== 
==1353== TO DEBUG THIS PROCESS USING GDB: start GDB like this
==1353==   /path/to/gdb ./server
==1353== and then give GDB the following command
==1353==   target remote | /usr/lib/x86_64-linux-gnu/valgrind/../../bin/vgdb --pid=1353
==1353== --pid is optional if only one valgrind process is running
==1353== 
--1353-- REDIR: 0x401e2f0 (ld-linux-x86-64.so.2:strlen) redirected to 0x580c9ce2 (vgPlain_amd64_linux_REDIR_FOR_strlen)
--1353-- REDIR: 0x401e0d0 (ld-linux-x86-64.so.2:index) redirected to 0x580c9cfc (vgPlain_amd64_linux_REDIR_FOR_index)
--1353-- Reading syms from /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_core-amd64-linux.so
--1353--   Considering /usr/lib/debug/.build-id/34/fbc4cdfbfce1bfc3d2e522a01a050bf724c930.debug ..
--1353--   .. build-id is valid
--1353-- Reading syms from /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so
--1353--   Considering /usr/lib/debug/.build-id/ca/bb7898ea982d936cbfadd70ae831c6eb63623f.debug ..
--1353--   .. build-id is valid
==1353== WARNING: new redirection conflicts with existing -- ignoring it
--1353--     old: 0x0401e2f0 (strlen              ) R-> (0000.0) 0x580c9ce2 vgPlain_amd64_linux_REDIR_FOR_strlen
--1353--     new: 0x0401e2f0 (strlen              ) R-> (2007.0) 0x04838d80 strlen
--1353-- REDIR: 0x401ab10 (ld-linux-x86-64.so.2:strcmp) redirected to 0x4839e40 (strcmp)
--1353-- REDIR: 0x401e830 (ld-linux-x86-64.so.2:mempcpy) redirected to 0x483d860 (mempcpy)
--1353-- Reading syms from /lib/x86_64-linux-gnu/libpthread-2.28.so
--1353--   Considering /usr/lib/debug/.build-id/15/45d6e6c7da9e2e706253a30cbfe720b9101e62.debug ..
--1353--   .. build-id is valid
--1353-- Reading syms from /lib/x86_64-linux-gnu/libc-2.28.so
--1353--   Considering /usr/lib/debug/.build-id/eb/6a5dd378d22b1e695984462a799cd4c81cdc22.debug ..
--1353--   .. build-id is valid
--1353-- REDIR: 0x48ffe20 (libc.so.6:memmove) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff1f0 (libc.so.6:strncpy) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4900100 (libc.so.6:strcasecmp) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48fec00 (libc.so.6:strcat) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff220 (libc.so.6:rindex) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4901600 (libc.so.6:rawmemchr) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4919fa0 (libc.so.6:wmemchr) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4919a40 (libc.so.6:wcscmp) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48fff90 (libc.so.6:mempcpy) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ffdc0 (libc.so.6:bcmp) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff190 (libc.so.6:strncmp) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48fec70 (libc.so.6:strcmp) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ffef0 (libc.so.6:memset) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4919a10 (libc.so.6:wcschr) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff130 (libc.so.6:strnlen) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48fed00 (libc.so.6:strcspn) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4900150 (libc.so.6:strncasecmp) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48fecd0 (libc.so.6:strcpy) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4900290 (libc.so.6:memcpy@@GLIBC_2.14) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x491b240 (libc.so.6:wcsnlen) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff250 (libc.so.6:strpbrk) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48fec30 (libc.so.6:index) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff100 (libc.so.6:strlen) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4905ff0 (libc.so.6:memrchr) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x49001a0 (libc.so.6:strcasecmp_l) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ffd90 (libc.so.6:memchr) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4919b20 (libc.so.6:wcslen) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x48ff4f0 (libc.so.6:strspn) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x49000d0 (libc.so.6:stpncpy) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x49000a0 (libc.so.6:stpcpy) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x4901630 (libc.so.6:strchrnul) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x49001f0 (libc.so.6:strncasecmp_l) redirected to 0x482b1b0 (_vgnU_ifunc_wrapper)
--1353-- REDIR: 0x49d29f0 (libc.so.6:__strrchr_avx2) redirected to 0x4838790 (rindex)
--1353-- REDIR: 0x49d2bc0 (libc.so.6:__strlen_avx2) redirected to 0x4838c60 (strlen)
--1353-- REDIR: 0x49d3100 (libc.so.6:__memcpy_avx_unaligned_erms) redirected to 0x483c8a0 (memmove)
--1353-- REDIR: 0x49d3580 (libc.so.6:__memset_avx2_unaligned_erms) redirected to 0x483c790 (memset)
--1353-- REDIR: 0x49d2800 (libc.so.6:__strchrnul_avx2) redirected to 0x483d390 (strchrnul)
--1353-- REDIR: 0x4913e70 (libc.so.6:__strcpy_sse2_unaligned) redirected to 0x4838db0 (strcpy)
--1353-- REDIR: 0x48fc1b0 (libc.so.6:calloc) redirected to 0x4837ab0 (calloc)
--1353-- REDIR: 0x48fb3e0 (libc.so.6:malloc) redirected to 0x4835710 (malloc)
--1353-- REDIR: 0x49d25d0 (libc.so.6:__strchr_avx2) redirected to 0x4838910 (index)
--1353-- REDIR: 0x49ce540 (libc.so.6:__strncmp_avx2) redirected to 0x4839410 (strncmp)
--1353-- REDIR: 0x48ff9f0 (libc.so.6:__GI_strstr) redirected to 0x483dac0 (__strstr_sse2)
--1353-- REDIR: 0x49cea50 (libc.so.6:__memchr_avx2) redirected to 0x4839ee0 (memchr)
--1353-- REDIR: 0x49d30e0 (libc.so.6:__mempcpy_avx_unaligned_erms) redirected to 0x483d4a0 (mempcpy)
--1353-- REDIR: 0x48fba30 (libc.so.6:free) redirected to 0x4836940 (free)
--1353-- REDIR: 0x49ce100 (libc.so.6:__strcmp_avx2) redirected to 0x4839d00 (strcmp)
--1353-- REDIR: 0x49d0c20 (libc.so.6:__strncasecmp_avx) redirected to 0x4839690 (strncasecmp)
--1353-- REDIR: 0x48fbc80 (libc.so.6:realloc) redirected to 0x4837d00 (realloc)
--1353-- REDIR: 0x49cde90 (libc.so.6:__strpbrk_sse42) redirected to 0x483dba0 (strpbrk)
--1353-- REDIR: 0x4915480 (libc.so.6:__stpcpy_sse2_unaligned) redirected to 0x483c3f0 (__stpcpy_sse2_unaligned)
--1353-- Reading syms from /lib/x86_64-linux-gnu/libnss_files-2.28.so
--1353--   Considering /usr/lib/debug/.build-id/a7/a102838762314663a5ccc6c15b4582b3a88ab7.debug ..
--1353--   .. build-id is valid
--1353-- REDIR: 0x49cf5b0 (libc.so.6:__strcasecmp_avx) redirected to 0x48395d0 (strcasecmp)
--1353-- Reading syms from /lib/x86_64-linux-gnu/libnss_dns-2.28.so
--1353--   Considering /usr/lib/debug/.build-id/fd/1243dd48e26486cbd2d4f4998f36e40ed2cbbb.debug ..
--1353--   .. build-id is valid
--1353-- Reading syms from /lib/x86_64-linux-gnu/libresolv-2.28.so
--1353--   Considering /usr/lib/debug/.build-id/2b/4fe50241eeb4be701366ec5ab5bf5e7f78324b.debug ..
--1353--   .. build-id is valid
--1353-- REDIR: 0x49cf1d0 (libc.so.6:__memcmp_avx2_movbe) redirected to 0x483c060 (bcmp)
==1353== Invalid read of size 4
==1353==    at 0x10E8F3: request_connect (socks5_request.c:134)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10E8FB: request_connect (socks5_request.c:138)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405d0 is 640 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 2
==1353==    at 0x10E90C: request_connect (socks5_request.c:138)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 4
==1353==    at 0x10E914: request_connect (socks5_request.c:138)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10E830: request_connect (socks5_request.c:151)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405d8 is 648 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10E837: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405d0 is 640 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10E83E: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10E841: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40468 is 280 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Syscall param socketcall.connect(serv_addr.sa_family) points to unaddressable byte(s)
==1353==    at 0x4867707: connect (connect.c:26)
==1353==    by 0x10E847: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Syscall param socketcall.connect(serv_addr.sin_port) points to unaddressable byte(s)
==1353==    at 0x4867707: connect (connect.c:26)
==1353==    by 0x10E847: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403ea is 154 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Syscall param socketcall.connect(serv_addr.sin_addr) points to unaddressable byte(s)
==1353==    at 0x4867707: connect (connect.c:26)
==1353==    by 0x10E847: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403ec is 156 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10E935: request_connect (socks5_request.c:155)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10E951: request_connect (socks5_request.c:160)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405e8 is 664 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10E95E: request_connect (socks5_request.c:160)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10F12E: jump (stm.c:37)
==1353==    by 0x10F12E: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40488 is 312 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10F13A: jump (stm.c:41)
==1353==    by 0x10F13A: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40490 is 320 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10F142: jump (stm.c:41)
==1353==    by 0x10F142: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40480 is 304 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10F110: handle_first (stm.c:27)
==1353==    by 0x10F110: stm_handler_write (stm.c:66)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40490 is 320 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10ED9F: request_connecting (socks5_request.c:281)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405c8 is 632 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 4
==1353==    at 0x10EDB3: request_connecting (socks5_request.c:289)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EDB7: next_ip (socks5_request.c:212)
==1353==    by 0x10EDB7: request_connecting (socks5_request.c:290)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d8 is 136 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EDC7: next_ip (socks5_request.c:212)
==1353==    by 0x10EDC7: request_connecting (socks5_request.c:290)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e0 is 144 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EDCE: next_ip (socks5_request.c:212)
==1353==    by 0x10EDCE: request_connecting (socks5_request.c:290)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59e78 is 40 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EED4: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405c8 is 632 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EEDB: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3D5: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40350 is 0 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3D9: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40360 is 16 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3DE: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40370 is 32 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3E3: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40380 is 48 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3E8: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40390 is 64 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 2
==1353==    at 0x10B3ED: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40350 is 0 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3F8: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403a0 is 80 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B3FD: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403b0 is 96 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B40A: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403c0 is 112 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B45A: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B462: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403f8 is 168 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B46F: get_ip (conn_logger.c:65)
==1353==    by 0x10B46F: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40408 is 184 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B477: get_ip (conn_logger.c:65)
==1353==    by 0x10B477: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40418 is 200 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B47F: get_ip (conn_logger.c:65)
==1353==    by 0x10B47F: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40428 is 216 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B487: get_ip (conn_logger.c:65)
==1353==    by 0x10B487: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40438 is 232 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B497: get_ip (conn_logger.c:65)
==1353==    by 0x10B497: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40448 is 248 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10B49F: get_ip (conn_logger.c:65)
==1353==    by 0x10B49F: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40458 is 264 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 2
==1353==    at 0x10B4AF: get_ip (conn_logger.c:65)
==1353==    by 0x10B4AF: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 2
==1353==    at 0x10B501: log_conn (conn_logger.c:75)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40352 is 2 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 2
==1353==    at 0x10B506: log_conn (conn_logger.c:75)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403ea is 154 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EEE2: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405c8 is 632 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EEE9: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EE5E: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404a0 is 336 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C664: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404b0 is 352 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10C669: request_marshall (request.c:204)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404ac is 348 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C66D: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404c0 is 368 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C672: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404d0 is 384 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C680: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404e0 is 400 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C685: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404f0 is 416 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C68F: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40500 is 432 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C694: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40510 is 448 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C69E: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40520 is 464 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C6A3: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40530 is 480 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C6B0: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40540 is 496 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C6B8: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40550 is 512 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C6C5: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40560 is 528 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C70A: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40570 is 544 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C712: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40580 is 560 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C71A: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40590 is 576 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 16
==1353==    at 0x10C722: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405a0 is 592 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 2
==1353==    at 0x10C72A: request_marshall (request.c:206)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405b0 is 608 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10AFF0: buffer_write_ptr (buffer.c:32)
==1353==    by 0x10C75A: request_marshall (request.c:208)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10AFF4: buffer_write_ptr (buffer.c:32)
==1353==    by 0x10C75A: request_marshall (request.c:208)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42648 is 8,952 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 1
==1353==    at 0x10C79A: request_marshall (request.c:240)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40620 is 720 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 1
==1353==    at 0x10C7A4: request_marshall (request.c:242)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40622 is 722 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 1
==1353==    at 0x10C7B1: request_marshall (request.c:241)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40621 is 721 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 1
==1353==    at 0x10C7B8: request_marshall (request.c:243)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40623 is 723 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 2
==1353==    at 0x483C9DB: memmove (vg_replace_strmem.c:1270)
==1353==    by 0x10C7C0: request_marshall (request.c:244)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40624 is 724 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 2
==1353==    at 0x10C7D4: request_marshall (request.c:246)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a4063a is 746 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B085: buffer_write_adv (buffer.c:52)
==1353==    by 0x10C7DD: request_marshall (request.c:247)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 8
==1353==    at 0x10B089: buffer_write_adv (buffer.c:52)
==1353==    by 0x10C7DD: request_marshall (request.c:247)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B08D: buffer_write_adv (buffer.c:53)
==1353==    by 0x10C7DD: request_marshall (request.c:247)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42648 is 8,952 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EE7A: request_connecting (socks5_request.c:305)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40608 is 696 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EE8A: request_connecting (socks5_request.c:305)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 8
==1353==    at 0x10F172: jump (stm.c:45)
==1353==    by 0x10F172: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40490 is 320 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EF0C: request_write (socks5_request.c:319)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404a0 is 336 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B040: buffer_read_ptr (buffer.c:44)
==1353==    by 0x10EF1A: request_write (socks5_request.c:323)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B044: buffer_read_ptr (buffer.c:44)
==1353==    by 0x10EF1A: request_write (socks5_request.c:323)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Syscall param socketcall.sendto(msg) points to unaddressable byte(s)
==1353==    at 0x486793E: __libc_send (send.c:28)
==1353==    by 0x486793E: send (send.c:23)
==1353==    by 0x10EF2F: request_write (socks5_request.c:324)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40620 is 720 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B0A9: buffer_read_adv (buffer.c:60)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 8
==1353==    at 0x10B0AD: buffer_read_adv (buffer.c:60)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B0B1: buffer_read_adv (buffer.c:61)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B0C8: buffer_compact (buffer.c:92)
==1353==    by 0x10B0C8: buffer_read_adv (buffer.c:65)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42640 is 8,944 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid write of size 8
==1353==    at 0x10B0DF: buffer_compact (buffer.c:95)
==1353==    by 0x10B0DF: buffer_read_adv (buffer.c:65)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B030: buffer_can_read (buffer.c:39)
==1353==    by 0x10EF60: request_write (socks5_request.c:329)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10B034: buffer_can_read (buffer.c:39)
==1353==    by 0x10EF60: request_write (socks5_request.c:329)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EF65: request_write (socks5_request.c:330)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405e8 is 664 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EF6F: request_write (socks5_request.c:330)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EF75: request_write (socks5_request.c:330)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EF8C: request_write (socks5_request.c:337)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405f0 is 672 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EF93: request_write (socks5_request.c:337)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10EF98: request_write (socks5_request.c:338)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405e8 is 664 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10EFA4: request_write (socks5_request.c:338)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10DC34: socks5_done (socks5.c:204)
==1353==    by 0x10DC34: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10DC3D: socks5_done (socks5.c:210)
==1353==    by 0x10DC3D: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== More than 100 errors detected.  Subsequent errors
==1353== will still be recorded, but in less detail than before.
==1353== Invalid read of size 4
==1353==    at 0x10DC44: socks5_done (socks5.c:211)
==1353==    by 0x10DC44: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 4
==1353==    at 0x10D985: socks5_close (socks5.c:225)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x10D9A8: socks5_free (socks5.c:235)
==1353==    by 0x10D9A8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d8 is 136 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x495AA50: freeaddrinfo (getaddrinfo.c:2534)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59df0 is 32 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== Invalid read of size 8
==1353==    at 0x495AA54: freeaddrinfo (getaddrinfo.c:2533)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59df8 is 40 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== Invalid free() / delete / delete[] / realloc()
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59dd0 is 0 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== Invalid free() / delete / delete[] / realloc()
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40350 is 0 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
--1353-- Discarding syms at 0x563e300-0x5644578 in /lib/x86_64-linux-gnu/libnss_files-2.28.so (have_dinfo 1)
--1353-- Discarding syms at 0x56511c0-0x5654563 in /lib/x86_64-linux-gnu/libnss_dns-2.28.so (have_dinfo 1)
--1353-- Discarding syms at 0x565c3a0-0x566807e in /lib/x86_64-linux-gnu/libresolv-2.28.so (have_dinfo 1)
==1353== 
==1353== HEAP SUMMARY:
==1353==     in use at exit: 0 bytes in 0 blocks
==1353==   total heap usage: 206 allocs, 266 frees, 866,454 bytes allocated
==1353== 
==1353== All heap blocks were freed -- no leaks are possible
==1353== 
==1353== ERROR SUMMARY: 1500 errors from 107 contexts (suppressed: 0 from 0)
==1353== 
==1353== 10 errors in context 1 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10DC44: socks5_done (socks5.c:211)
==1353==    by 0x10DC44: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 2 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10DC3D: socks5_done (socks5.c:210)
==1353==    by 0x10DC3D: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 3 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10DC34: socks5_done (socks5.c:204)
==1353==    by 0x10DC34: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 4 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EFA4: request_write (socks5_request.c:338)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 5 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EF98: request_write (socks5_request.c:338)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405e8 is 664 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 6 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EF93: request_write (socks5_request.c:337)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 7 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EF8C: request_write (socks5_request.c:337)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405f0 is 672 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 8 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EF75: request_write (socks5_request.c:330)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 9 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EF6F: request_write (socks5_request.c:330)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 10 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EF65: request_write (socks5_request.c:330)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405e8 is 664 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 11 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B034: buffer_can_read (buffer.c:39)
==1353==    by 0x10EF60: request_write (socks5_request.c:329)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 12 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B030: buffer_can_read (buffer.c:39)
==1353==    by 0x10EF60: request_write (socks5_request.c:329)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 13 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B0C8: buffer_compact (buffer.c:92)
==1353==    by 0x10B0C8: buffer_read_adv (buffer.c:65)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42640 is 8,944 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 14 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B0B1: buffer_read_adv (buffer.c:61)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 15 of 107:
==1353== Invalid write of size 8
==1353==    at 0x10B0AD: buffer_read_adv (buffer.c:60)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 16 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B0A9: buffer_read_adv (buffer.c:60)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 17 of 107:
==1353== Syscall param socketcall.sendto(msg) points to unaddressable byte(s)
==1353==    at 0x486793E: __libc_send (send.c:28)
==1353==    by 0x486793E: send (send.c:23)
==1353==    by 0x10EF2F: request_write (socks5_request.c:324)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40620 is 720 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 18 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B044: buffer_read_ptr (buffer.c:44)
==1353==    by 0x10EF1A: request_write (socks5_request.c:323)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 19 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B040: buffer_read_ptr (buffer.c:44)
==1353==    by 0x10EF1A: request_write (socks5_request.c:323)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 20 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EF0C: request_write (socks5_request.c:319)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404a0 is 336 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 21 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EE8A: request_connecting (socks5_request.c:305)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 22 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EE7A: request_connecting (socks5_request.c:305)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40608 is 696 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 23 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B08D: buffer_write_adv (buffer.c:53)
==1353==    by 0x10C7DD: request_marshall (request.c:247)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42648 is 8,952 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 24 of 107:
==1353== Invalid write of size 8
==1353==    at 0x10B089: buffer_write_adv (buffer.c:52)
==1353==    by 0x10C7DD: request_marshall (request.c:247)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 25 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10B085: buffer_write_adv (buffer.c:52)
==1353==    by 0x10C7DD: request_marshall (request.c:247)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 26 of 107:
==1353== Invalid write of size 1
==1353==    at 0x10C7B8: request_marshall (request.c:243)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40623 is 723 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 27 of 107:
==1353== Invalid write of size 1
==1353==    at 0x10C7B1: request_marshall (request.c:241)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40621 is 721 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 28 of 107:
==1353== Invalid write of size 1
==1353==    at 0x10C7A4: request_marshall (request.c:242)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40622 is 722 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 29 of 107:
==1353== Invalid write of size 1
==1353==    at 0x10C79A: request_marshall (request.c:240)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40620 is 720 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 30 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10AFF4: buffer_write_ptr (buffer.c:32)
==1353==    by 0x10C75A: request_marshall (request.c:208)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42648 is 8,952 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 31 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10AFF0: buffer_write_ptr (buffer.c:32)
==1353==    by 0x10C75A: request_marshall (request.c:208)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42658 is 8,968 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 32 of 107:
==1353== Invalid read of size 2
==1353==    at 0x10C72A: request_marshall (request.c:206)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405b0 is 608 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 33 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C722: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405a0 is 592 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 34 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C71A: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40590 is 576 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 35 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C712: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40580 is 560 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 36 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C70A: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40570 is 544 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 37 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C6C5: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40560 is 528 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 38 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C6B8: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40550 is 512 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 39 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C6B0: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40540 is 496 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 40 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C6A3: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40530 is 480 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 41 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C69E: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40520 is 464 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 42 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C694: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40510 is 448 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 43 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C68F: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40500 is 432 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 44 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C685: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404f0 is 416 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 45 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C680: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404e0 is 400 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 46 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C672: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404d0 is 384 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 47 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C66D: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404c0 is 368 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 48 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10C669: request_marshall (request.c:204)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404ac is 348 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 49 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10C664: request_marshall (request.c:205)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404b0 is 352 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 50 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EE5E: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a404a0 is 336 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 51 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EEE9: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 52 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EEE2: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405c8 is 632 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 53 of 107:
==1353== Invalid read of size 2
==1353==    at 0x10B506: log_conn (conn_logger.c:75)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403ea is 154 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 54 of 107:
==1353== Invalid read of size 2
==1353==    at 0x10B501: log_conn (conn_logger.c:75)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40352 is 2 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 55 of 107:
==1353== Invalid read of size 2
==1353==    at 0x10B4AF: get_ip (conn_logger.c:65)
==1353==    by 0x10B4AF: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 56 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B49F: get_ip (conn_logger.c:65)
==1353==    by 0x10B49F: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40458 is 264 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 57 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B497: get_ip (conn_logger.c:65)
==1353==    by 0x10B497: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40448 is 248 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 58 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B487: get_ip (conn_logger.c:65)
==1353==    by 0x10B487: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40438 is 232 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 59 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B47F: get_ip (conn_logger.c:65)
==1353==    by 0x10B47F: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40428 is 216 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 60 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B477: get_ip (conn_logger.c:65)
==1353==    by 0x10B477: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40418 is 200 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 61 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B46F: get_ip (conn_logger.c:65)
==1353==    by 0x10B46F: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40408 is 184 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 62 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B462: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403f8 is 168 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 63 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B45A: log_conn (conn_logger.c:43)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 64 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B40A: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403c0 is 112 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 65 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3FD: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403b0 is 96 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 66 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3F8: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403a0 is 80 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 67 of 107:
==1353== Invalid read of size 2
==1353==    at 0x10B3ED: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40350 is 0 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 68 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3E8: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40390 is 64 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 69 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3E3: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40380 is 48 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 70 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3DE: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40370 is 32 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 71 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3D9: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40360 is 16 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 72 of 107:
==1353== Invalid read of size 16
==1353==    at 0x10B3D5: log_conn (conn_logger.c:41)
==1353==    by 0x10EEE1: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40350 is 0 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 73 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10EEDB: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 74 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EED4: request_connecting (socks5_request.c:294)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405c8 is 632 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 75 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EDCE: next_ip (socks5_request.c:212)
==1353==    by 0x10EDCE: request_connecting (socks5_request.c:290)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59e78 is 40 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== 
==1353== 10 errors in context 76 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EDC7: next_ip (socks5_request.c:212)
==1353==    by 0x10EDC7: request_connecting (socks5_request.c:290)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e0 is 144 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 77 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10EDB7: next_ip (socks5_request.c:212)
==1353==    by 0x10EDB7: request_connecting (socks5_request.c:290)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d8 is 136 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 78 of 107:
==1353== Invalid write of size 4
==1353==    at 0x10EDB3: request_connecting (socks5_request.c:289)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 79 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10ED9F: request_connecting (socks5_request.c:281)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405c8 is 632 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 80 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10E95E: request_connect (socks5_request.c:160)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d4 is 132 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 81 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10E951: request_connect (socks5_request.c:160)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405e8 is 664 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 82 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10E935: request_connect (socks5_request.c:155)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 83 of 107:
==1353== Syscall param socketcall.connect(serv_addr.sin_addr) points to unaddressable byte(s)
==1353==    at 0x4867707: connect (connect.c:26)
==1353==    by 0x10E847: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403ec is 156 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 84 of 107:
==1353== Syscall param socketcall.connect(serv_addr.sin_port) points to unaddressable byte(s)
==1353==    at 0x4867707: connect (connect.c:26)
==1353==    by 0x10E847: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403ea is 154 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 85 of 107:
==1353== Syscall param socketcall.connect(serv_addr.sa_family) points to unaddressable byte(s)
==1353==    at 0x4867707: connect (connect.c:26)
==1353==    by 0x10E847: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 86 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10E841: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40468 is 280 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 87 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10E83E: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 88 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10E837: request_connect (socks5_request.c:152)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405d0 is 640 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 89 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10E830: request_connect (socks5_request.c:151)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405d8 is 648 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 90 of 107:
==1353== Invalid write of size 4
==1353==    at 0x10E914: request_connect (socks5_request.c:138)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 91 of 107:
==1353== Invalid read of size 2
==1353==    at 0x10E90C: request_connect (socks5_request.c:138)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403e8 is 152 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 92 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10E8FB: request_connect (socks5_request.c:138)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a405d0 is 640 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 10 errors in context 93 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10E8F3: request_connect (socks5_request.c:134)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40470 is 288 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 94 of 107:
==1353== Invalid free() / delete / delete[] / realloc()
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40350 is 0 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 95 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10D9A8: socks5_free (socks5.c:235)
==1353==    by 0x10D9A8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a403d8 is 136 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 96 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10D985: socks5_close (socks5.c:225)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42660 is 8,976 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 97 of 107:
==1353== Invalid write of size 8
==1353==    at 0x10F172: jump (stm.c:45)
==1353==    by 0x10F172: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40490 is 320 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 98 of 107:
==1353== Invalid write of size 8
==1353==    at 0x10B0DF: buffer_compact (buffer.c:95)
==1353==    by 0x10B0DF: buffer_read_adv (buffer.c:65)
==1353==    by 0x10EF58: request_write (socks5_request.c:328)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a42650 is 8,960 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 99 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10F110: handle_first (stm.c:27)
==1353==    by 0x10F110: stm_handler_write (stm.c:66)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40490 is 320 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 20 errors in context 100 of 107:
==1353== Invalid write of size 2
==1353==    at 0x10C7D4: request_marshall (request.c:246)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a4063a is 746 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 30 errors in context 101 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10F142: jump (stm.c:41)
==1353==    by 0x10F142: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40480 is 304 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 30 errors in context 102 of 107:
==1353== Invalid read of size 8
==1353==    at 0x10F13A: jump (stm.c:41)
==1353==    by 0x10F13A: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40490 is 320 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 30 errors in context 103 of 107:
==1353== Invalid read of size 4
==1353==    at 0x10F12E: jump (stm.c:37)
==1353==    by 0x10F12E: stm_handler_write (stm.c:71)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40488 is 312 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== 
==1353== 40 errors in context 104 of 107:
==1353== Invalid free() / delete / delete[] / realloc()
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59dd0 is 0 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== 
==1353== 40 errors in context 105 of 107:
==1353== Invalid read of size 8
==1353==    at 0x495AA54: freeaddrinfo (getaddrinfo.c:2533)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59df8 is 40 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== 
==1353== 40 errors in context 106 of 107:
==1353== Invalid read of size 8
==1353==    at 0x495AA50: freeaddrinfo (getaddrinfo.c:2534)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10DC92: socks5_done (socks5.c:216)
==1353==    by 0x10DC92: socks5_write (socks5.c:189)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a59df0 is 32 bytes inside a block of size 64 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x495AA67: freeaddrinfo (getaddrinfo.c:2535)
==1353==    by 0x10D9B8: socks5_free (socks5.c:236)
==1353==    by 0x10D9B8: socks5_close (socks5.c:228)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x49591F5: gaih_inet.constprop.7 (getaddrinfo.c:1068)
==1353==    by 0x495ABA6: getaddrinfo (getaddrinfo.c:2265)
==1353==    by 0x10E721: request_resolv_blocking (socks5_request.c:247)
==1353==    by 0x485DFA2: start_thread (pthread_create.c:486)
==1353==    by 0x496FEFE: clone (clone.S:95)
==1353== 
==1353== 
==1353== 220 errors in context 107 of 107:
==1353== Invalid write of size 2
==1353==    at 0x483C9DB: memmove (vg_replace_strmem.c:1270)
==1353==    by 0x10C7C0: request_marshall (request.c:244)
==1353==    by 0x10EE70: request_connecting (socks5_request.c:299)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Address 0x4a40624 is 724 bytes inside a block of size 8,984 free'd
==1353==    at 0x48369AB: free (vg_replace_malloc.c:530)
==1353==    by 0x10CEFA: selector_unregister_fd (selector.c:378)
==1353==    by 0x10E8F2: request_connect (socks5_request.c:133)
==1353==    by 0x10EE18: request_connecting (socks5_request.c:291)
==1353==    by 0x10F12A: stm_handler_write (stm.c:70)
==1353==    by 0x10DC19: socks5_write (socks5.c:186)
==1353==    by 0x10D5DB: handle_iteration (selector.c:452)
==1353==    by 0x10D5DB: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353==  Block was alloc'd at
==1353==    at 0x483577F: malloc (vg_replace_malloc.c:299)
==1353==    by 0x10DA2A: socks5_new (socks5.c:88)
==1353==    by 0x10DA2A: socks5_passive_accept (socks5.c:152)
==1353==    by 0x10D5A1: handle_iteration (selector.c:443)
==1353==    by 0x10D5A1: selector_select (selector.c:541)
==1353==    by 0x10A673: main (server.c:144)
==1353== 
==1353== ERROR SUMMARY: 1500 errors from 107 contexts (suppressed: 0 from 0)
